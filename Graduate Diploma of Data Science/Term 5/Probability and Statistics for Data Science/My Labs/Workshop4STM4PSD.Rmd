---
title: "Workshop4STM4PSD"
output: word_document
date: "2023-11-23"
---

#Question 1
```{r}
#Part a
dbinom(10,100,0.3)

#Part b
pbinom(10,100,0.3)

#Part c
pbinom(9,100,0.3)

#Part d
1-pbinom(10,100,0.3)
#Part e
1-pbinom(9,100,0.3)

#Part f
pbinom(9,100,0.3)-pbinom(4,100,0.3)



```


#Question 2, Use R to verify the answers to Q8 from workshop 1.
```{r}
#a.
dbinom(3,10,0.3)
#b.
pbinom(1,10,0.3)
#c.
1-pbinom(1,10,0.3)
#d.
#1-pbinom(7,10,0.3)
1 - pbinom(8, 10, 0.3)

#e.
pbinom(9,10,0.3)
#f.
pbinom(9,10,0.3)-pbinom(1,10,0.3)
```

#Question 3. Use ?distributions in the console and redo
#Workshop 1 Q9
#For the negative binomial distribution see dnbinom.
```{r}
#a
dnbinom(3,3,0.15)
#b
pnbinom(1,3,0.15)
#c
1-dnbinom(1,3,0.15)
#d
dnbinom(2,3,0.15)+dnbinom(3,3,0.15)
#pnbinom(3, size=3, prob=0.15) - pnbinom(1, size=3, prob=0.15)

```

#Question 4. Redo Workshop 1 Q7 that involves computing probabilities. 
```{r}
#b
#first approach
pgeom(5,1/3)

#second approach
1-dbinom(0,6,1/3)

#d
pbinom(9,365,20/365)

#f
1-dbinom(0,5,0.1)
#g
pbinom(20,1250,0.01)
```

#Question 5
```{r}
#a
binom.less <- function(q,size,prob){
  pbinom(q-1,size,prob)
}

#b
binom.geq <- function(q,size,prob){
  1-binom.less(q,size,prob)
}


#c
binom.between <-function(a,b,size,prob){
  #pbinom(b,size,prob) - pbinom(a-1,size,prob)
  pbinom(b,size,prob) - pbinom(a,size,prob)
}

#P(X<5)
binom.less(5,10,0.5)

#P(X>=5)
binom.geq(5,10,0.5)

```
#Plotting graphs in R
```{r}
curve(cos,from=-4*pi,to=4*pi)

```


```{r}
curve(cos,from=-15,to=5,xlim=c(-20,15),xlab="X",ylab="Y",lwd=5,col="blue")

```


#Question 6
```{r}
#Put the formula directly into the curve function
curve(x^2, from = -10, to =3)

```
```{r}
#define the function separately, and then pass it as an argument 
#to the curve function.
f <- function(x){x^2 + 1}
#n increases making the function smoother
curve(f,from=-10,to=3,n=10000)
```
#Another approach makes use of anonymous functions 
#cos function
```{r}
curve(cos,from=-10,to=10,col="blue")
```
#sin function
```{r}
curve(sin,from=-10,to=10,col="red",add=TRUE)
```


```{r}
#define the function separately, and then pass it as an argument 
#to the curve function.
f <- function(x){x^2 + 1}
curve(f,from=-10,to=3)
```


#Question 7
```{r}
g<-function(x){
  3*(x+1)*(1-x)/4
}
#lwd makes the function bolder
curve(g,from=-3,to=3,n=50000,lwd=3) 
abline(h=0,v=0)
```


#Question 8
```{r}
1:6 == 3

```
```{r}
1:6 >= 3

```

#Question 9
```{r}
0:6 == (0:6)^2
```

#Using the function, in Example 4.4.2. as follows
```{r}
f<-function(x) if(x>= -1 & x <= 2){(x-1)^2/3}else{0}


```

#Question 10
```{r}
f(-2)
f(-1)
f(0)
f(1)
f(2)
```
#vectorised functions
```{r}
x <- -10:10
(x-1)^2/3
log(x)
```

#Question 11
```{r}
f(1:6)
f(-2:2)
```
```{r}
#The following will NOT work
f<-function(x){
  if (x>=-1 & x <= 2){(x-1)^2/3}else{0}
}
curve(f,from=-10,to=10)
```

```{r}
#The following will work
f<-function(x){
  ifelse(x>=-1 & x<=2,(x-1)^2/3,0)
}
curve(f,from=-10,to=10)
```
```{r}
curve(f,from=-1,to=2,xlim=c(-10,10))
lines(x=c(-10,-1),y=c(0,0))
lines(x=c(2,10),y=c(0,0))
points(x=c(-1,2),y=f(c(-1,2)),pch=19)
points(x=c(-1,2),y=c(0,0),pch=21,bg="white")
```



#Question 12
```{r}
#a
f <- function(x){
  ifelse(x>=1 & x <= 1.5, 4*x-4,ifelse(x>=1.5 & x<= 2,8-4*x,0))
}

#b
f <- Vectorize ( f )

curve(f,from=0,to=2,lwd=3)
```




