---
title: "part3_code"
output: word_document
date: "2023-10-17"
---

#Here
```{r}
bikes <- read.csv("C:/Users/mikel/OneDrive/Desktop/Assessment_2_STM4PSD/bikes.csv",header=TRUE)
bikes

```



```{r}
#The average number of casual users, registered users, and total users per day
avg_casual <- mean(bikes$casual)
avg_reg <- mean(bikes$registered)
avg_total <- mean(bikes$casual+bikes$registered)
avg_casual
avg_reg
avg_total

```



# OUR GOAL IS TO PERFORM A LOT OF CONFIDENCE INTERVALS

#I.e. There are four types of Confidence Intervals 

#Single Mean (DONE)
#Proportion (DONE)
#Difference in two means (DONE)
#Unpaired Difference in two means (DONE)


#Single Means (assuming were given a standard derivation)
```{r}

interval <- function(data){
  mean(data) + c(-1,1)*1.96*sd(data)/sqrt(length(data))
}

#95% Confidence Interval for Casual users
interval(bikes$casual)

#95% Confidence Interval for Registered Users
interval(bikes$registered)

#95% Confidence Interval for All Users
interval(bikes$casual+bikes$registered)

```
#Single Means (assuming we do not know the population standard derivation)
#Using the t-test
```{r}
#Using the t test for the Casual users
t.test(bikes$casual , mu =avg_casual)

```

```{r}
#Using the t test for the Registered users
t.test(bikes$registered , mu = avg_reg)

```


```{r}
#Using the t test for the Total users
t.test(bikes$casual+ bikes$registered , mu = avg_total)

```

#Proportion Confidence Interval for registered users amongst all users

```{r}

#Proportion of the registered users among all users
prop_reg <- sum(bikes$registered)/(sum(bikes$registered)+sum(bikes$casual))

#Standard error 
se_reg <- sqrt((prop_reg*(1-prop_reg))/(length(bikes$registered)))

#Therefore the approximate 95% confidence interval. 

prop_reg + c(-1,1)*1.96*se_reg

#Thus, we are 95% sure that the true probability of registered users occur 
#between 0.66 and 0.88.

```


#Difference in two means Confidence Interval in usage by casual users vs. registered users.
#Paired t-test
```{r}
#Using the t.test and compare the usage between casual vs. registered users 
t.test(bikes$registered,bikes$casual,paired=TRUE)

#Which gives us the 95% confidence interval of
#[2006.980,2710.699]

```


#Difference of two means
#Whether there are yearly differences in bikeshare usage.

```{r}
bikes.2011 <- bikes[bikes$year == 2011,]
bikes.2012 <- bikes[bikes$year == 2012,]

```


#Compute the total bikeshare usage from 2011 and 2012.
```{r}
total_users_2011<-bikes.2011$casual+bikes.2011$registered
total_users_2012<-bikes.2012$casual+bikes.2012$registered
```



#Check for Yearly differences in bikeshare usage, Using R t-test unpaired. 
```{r}
t.test(total_users_2011,total_users_2012)
#[ -2705.1444,-708.0699]

```


